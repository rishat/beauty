<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Сделай красиво</title>
    <script>
        // Глобальная переменная для идентификатора интервала конфетти
        let confettiInterval;

        function makeItBeautiful() {
            // Добавление стилей
            document.body.style.fontFamily = "'Segoe UI', Tahoma, Geneva, Verdana, sans-serif";
            document.body.style.backgroundColor = "#f8f9fa";
            document.body.style.color = "#343a40";
            document.body.style.lineHeight = "1.6";
            document.body.style.padding = "20px";
            document.body.style.maxWidth = "800px";
            document.body.style.margin = "0 auto";
            document.body.style.transition = "all 0.5s ease";

            // Стилизация заголовка и изменение текста
            const heading = document.querySelector("h1");
            heading.textContent = "Красивая страничка"; // Изменяем текст заголовка
            heading.style.color = "#6c5ce7";
            heading.style.textAlign = "center";
            heading.style.fontSize = "2.5em";
            heading.style.marginBottom = "30px";
            heading.style.textShadow = "2px 2px 4px rgba(0,0,0,0.1)";

            // Стилизация параграфа
            const paragraphs = document.querySelectorAll("p");
            paragraphs.forEach(p => {
                p.style.fontSize = "1.1em";
                p.style.marginBottom = "15px";
                p.style.textAlign = "justify";
            });

            // Стилизация кнопки
            const button = document.querySelector("button");
            button.style.backgroundColor = "#6c5ce7";
            button.style.color = "white";
            button.style.border = "none";
            button.style.padding = "12px 24px";
            button.style.fontSize = "16px";
            button.style.borderRadius = "8px";
            button.style.cursor = "pointer";
            button.style.boxShadow = "0 4px 6px rgba(0,0,0,0.1)";
            button.style.display = "block";
            button.style.margin = "30px auto";
            button.style.transition = "transform 0.3s ease";
            button.textContent = "Уже красиво!";

            // Создаем и запускаем бесконечное конфетти
            startInfiniteConfetti();
        }

        function startInfiniteConfetti() {
            // Создаем контейнер один раз
            const container = document.createElement('div');
            container.style.position = 'fixed';
            container.style.top = '0';
            container.style.left = '0';
            container.style.width = '100%';
            container.style.height = '100%';
            container.style.pointerEvents = 'none';
            container.style.zIndex = '1000';
            document.body.appendChild(container);

            // Запускаем первую порцию конфетти
            createConfettiBatch(container);

            // Запускаем интервал для непрерывного создания конфетти
            confettiInterval = setInterval(() => {
                createConfettiBatch(container);
            }, 800); // Создаем новую партию конфетти каждые 800 мс

            // Добавляем кнопку для остановки конфетти
            const button = document.querySelector("button");
            button.textContent = "Сделай красиво";
            button.disabled = false;
            button.onclick = stopConfetti;
        }

        function createConfettiBatch(container) {
            const confettiCount = 100; // Количество конфетти в одной партии

            // Базовые цвета
            const baseColors = [
                '#FF577F', '#FF884B', '#FFD384', '#FFF9B0', // тёплые
                '#7FE9DE', '#A6E3E9', '#CBF1F5', '#E3FDFD', // холодные
                '#E384FF', '#865DFF', '#8661C1', '#DFCCFB', // фиолетовые
                '#FFEE63', '#FCF69C', '#FFDEDE', '#E8A0BF'  // пастельные
            ];

            // Создаем разные типы конфетти
            for (let i = 0; i < confettiCount; i++) {
                // Определяем тип конфетти (0: обычное, 1: блестящее, 2: большое)
                const confettiType = Math.floor(Math.random() * 3);

                const confetti = document.createElement('div');
                confetti.style.position = 'absolute';

                // Размеры конфетти в зависимости от типа
                if (confettiType === 2) {
                    // Большое конфетти
                    confetti.style.width = Math.random() * 15 + 10 + 'px';
                    confetti.style.height = Math.random() * 15 + 10 + 'px';
                } else {
                    // Обычное конфетти
                    confetti.style.width = Math.random() * 8 + 5 + 'px';
                    confetti.style.height = Math.random() * 8 + 3 + 'px';
                }

                // Форма конфетти
                const shapeType = Math.floor(Math.random() * 3);
                if (shapeType === 0) {
                    // Круглое
                    confetti.style.borderRadius = '50%';
                } else if (shapeType === 1) {
                    // Звездообразное
                    confetti.style.clipPath = 'polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%)';
                }

                // Выбор цвета и эффектов
                const baseColor = baseColors[Math.floor(Math.random() * baseColors.length)];

                if (confettiType === 1) {
                    // Блестящее конфетти
                    confetti.style.background = `linear-gradient(135deg, ${baseColor}, white, ${baseColor})`;
                    confetti.style.boxShadow = `0 0 5px ${baseColor}, 0 0 10px white`;

                    // Добавляем анимацию блеска
                    const shimmerKeyframes = `
                        @keyframes shimmer${i} {
                            0% { background-position: -100px; }
                            100% { background-position: 100px; }
                        }
                    `;
                    const styleSheet = document.createElement('style');
                    styleSheet.textContent = shimmerKeyframes;
                    document.head.appendChild(styleSheet);

                    confetti.style.backgroundSize = '200% 100%';
                    confetti.style.animation = `shimmer${i} 1s infinite linear`;
                } else {
                    // Обычное конфетти
                    confetti.style.backgroundColor = baseColor;
                }

                // Позиционирование
                confetti.style.top = '-50px';
                confetti.style.left = Math.random() * 100 + '%';
                confetti.style.opacity = Math.random() * 0.5 + 0.5;
                confetti.style.transform = 'rotate(' + Math.random() * 360 + 'deg)';

                container.appendChild(confetti);

                // Анимация падения
                const duration = Math.random() * 4 + 3; // от 3 до 7 секунд
                const leftSwing = Math.random() * 50 - 25; // больший разброс

                // Создаем более сложную анимацию для разных типов конфетти
                const keyframes = [
                    {
                        top: '-50px',
                        left: confetti.style.left,
                        transform: `rotate(0deg) scale(1)`,
                        opacity: confetti.style.opacity
                    },
                    {
                        top: '25%',
                        left: `calc(${confetti.style.left} + ${leftSwing / 2}px)`,
                        transform: `rotate(${Math.random() * 360}deg) scale(${Math.random() * 0.5 + 0.8})`,
                        opacity: confetti.style.opacity
                    },
                    {
                        top: '50%',
                        left: `calc(${confetti.style.left} + ${-leftSwing / 2}px)`,
                        transform: `rotate(${Math.random() * 360}deg) scale(${Math.random() * 0.5 + 0.8})`,
                        opacity: confetti.style.opacity
                    },
                    {
                        top: '110%',
                        left: `calc(${confetti.style.left} + ${leftSwing}px)`,
                        transform: `rotate(${Math.random() * 720}deg) scale(${Math.random() * 0.5 + 0.5})`,
                        opacity: 0
                    }
                ];

                const animation = confetti.animate(keyframes, {
                    duration: duration * 1000,
                    easing: 'cubic-bezier(.25,.46,.45,.94)',
                    fill: 'forwards'
                });

                // Удаляем элемент после завершения анимации
                animation.onfinish = () => {
                    confetti.remove();
                };
            }
        }

        function stopConfetti() {
            // Останавливаем интервал создания конфетти
            clearInterval(confettiInterval);

            // Изменяем текст кнопки и обработчик события
            const button = document.querySelector("button");
            button.onclick = startConfettiAgain;
        }

        function startConfettiAgain() {
            // Удаляем старый контейнер с конфетти, если он существует
            const oldContainer = document.querySelector('div[style*="position: fixed"]');
            if (oldContainer) {
                oldContainer.remove();
            }

            // Запускаем конфетти заново
            startInfiniteConfetti();
        }
    </script>
</head>
<body>
    <h1>Некрасивая страничка</h1>
    <button onclick="makeItBeautiful()">Сделай красиво</button>
</body>
</html>
